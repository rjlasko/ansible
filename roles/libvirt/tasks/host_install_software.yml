---
## -------------------------------------------------- ##
## Installs libvirt and related libraries & utilities ##
## -------------------------------------------------- ##


- name: install libvirt libraries and tools
  package:
    state: present
    name:
      - python3-lxml
      - qemu-kvm
      # - qemu-system
      - qemu-utils
      - python3-libvirt
      - libvirt-daemon-system
      - libvirt-clients
      - virtinst
  # TODO: checkout "ovirt" instead of "virt-manager"
      - virt-manager
  # XXX: UEFI support for VMs
      - ovmf
  # XXX: evaluate purpose
      # - libguestfs-tools
      # - genisoimage
  register: libvirt_software_install

- name: restart libvirtd
  when: libvirt_software_install.changed
  service:
    name: libvirtd
    state: restarted
    enabled: true
