---
## --------------------- ##
## Installs ZFS on Linux ##
## --------------------- ##


- name: fail on unsupported distributions
  when: >
    ansible_facts['distribution'] != 'Debian' and
    ansible_facts['distribution'] != 'Ubuntu' and
    ansible_facts['distribution'] != 'Pop!_OS'
  fail:
    msg: "Only supports Debian based distributions"

- name: Install ZFS on Debian
  when: ansible_facts['distribution'] == 'Debian'
  include_tasks: install_zfs_debian.yml

- name: Install ZFS on Ubuntu variants
  when: >
    ansible_facts['distribution'] == 'Ubuntu' or
    ansible_facts['distribution'] == 'Pop!_OS'
  include_tasks: install_zfs_ubuntu.yml
