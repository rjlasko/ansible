---
## ---------------------------------------------------------------- ##
## Automates the installation and setup of libvirt hosts and guests ##
## ---------------------------------------------------------------- ##

- name: setup target as libvirt host
  when: libvirt.host is defined
  import_tasks: host.yml
  vars:
    libvirt_host: "{{ libvirt.host }}"

- name: setup targets as libvirt guests
  when: libvirt.guests is defined
  loop: "{{ libvirt.guests | default([]) }}"
  loop_control:
    loop_var: virt_install_vm
  include: guest.yml
  vars:
    libvirt_vm: "{{ virt_install_vm }}"
