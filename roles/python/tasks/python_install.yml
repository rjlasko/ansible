---
## ------------------------------------------ ##
## Installs python via system package manager ##
## ------------------------------------------ ##

- name: resolve system package names to install
  loop: "{{ python_versions }}"
  loop_control:
    loop_var: python_system_version
  set_fact:
    python_system_packages: "{{ python_system_packages + [ python_package_pattern[ansible_facts.os_family] | format(python_system_version) ] }}"

- name: install python versions (MacOS)
  when: ansible_facts.system == 'Darwin'
  community.general.homebrew:
    name: "{{ python_system_packages }}"
    state: present

- name: "install python versions ({{ ansible_facts.os_family }} Linux)"
  when: ansible_facts.system == 'Linux'
  become: true
  ansible.builtin.package:
    name: "{{ python_system_packages }}"
    state: present
